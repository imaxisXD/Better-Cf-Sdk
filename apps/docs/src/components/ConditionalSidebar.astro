---
import DefaultSidebar from '@astrojs/starlight/components/Sidebar.astro';

const props = Astro.props;

const currentSlug = typeof props.slug === 'string' ? props.slug : '';
const suiteModeSlugs = new Set(['', 'why-better-cf', 'reference/roadmap']);
const suiteMode = suiteModeSlugs.has(currentSlug);

const originalSidebar = Array.isArray(props.sidebar) ? props.sidebar : [];
const groups = originalSidebar.filter((entry) => entry?.type === 'group');
const groupByLabel = new Map(groups.map((entry) => [entry.label, entry]));

const orderedLabels = suiteMode ? ['Suite', 'Queue SDK'] : ['Queue SDK', 'Suite'];
const orderedGroups = orderedLabels
  .map((label) => groupByLabel.get(label))
  .filter(Boolean);

const remainingGroups = groups.filter((entry) => !orderedLabels.includes(entry.label));
const sidebar = [...orderedGroups, ...remainingGroups];
---

<DefaultSidebar {...props} sidebar={sidebar} />
